#!/usr/bin/env node
require("dotenv").config({ path: '../local.env' });
var requireEnv = require("require-environment-variables");
requireEnv([
    'APP_ID',
    'MASTER_KEY'
]);

var http = require('http-request');
var _ = require('lodash');


var task = (_.includes(process.argv, '-f')) ? 'forceResetTasks' : 'resetTasks';

console.log('process.env.SERVER_URL: ', process.env.SERVER_URL);

http.post({
    url: process.env.SERVER_URL + '/jobs/' + task,
    headers: {
        'X-Parse-Application-Id': process.env.APP_ID,
        'X-Parse-Master-Key': process.env.MASTER_KEY,
        'Content-Type': "application/json"
    }
}, function (err, res) {
    if (err) {
        console.error(err);
        return;
    }

    console.log(res.code, res.headers, res.file);
});